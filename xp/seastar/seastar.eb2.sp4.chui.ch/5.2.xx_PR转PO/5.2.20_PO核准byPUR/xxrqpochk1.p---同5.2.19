/* xxrqpochk1.p      PO审核sub程式                                              */
/* Copyright 1986-2002 QAD Inc., Carpinteria, CA, USA.                      */
/* All rights reserved worldwide.  This is an unpublished work.             */
/*V8:ConvertMode=NoConvert                                                  */
/* REVISION: 1.0      LAST MODIFIED: 10/08/07   BY: Softspeed roger xiao    */
/*-Revision end---------------------------------------------------------------*/


define input parameter v_nbr  like pod_nbr .
define input parameter v_line like pod_line .

define  shared var v_lt   as logical label "满足LT" .
define  shared temp-table temp 
	field t_select   as char  format "x(1)"   
	field t_nbr      like po_nbr              
	field t_line     like pod_line       
	field t_podline     like pod_line  
	field t_date     like po_ord_date         
	field t_part     like pod_part            
	field t_qty      like pod_qty_ord         
	field t_price    like pod_pur_cost        
	field t_app      as logical  format "Yes/No" 
	field t_rmks     as char format "x(60)"      . 

define  shared  frame b.
form
	t_nbr       label "采购单" 
	pod_part    no-label 	    colon 18
	po_cr_terms label "支付方式" colon 50
	pod_need    label "需求日"   colon 68

	t_line      label "项次"    colon 5
	pt_desc1    no-label		colon 18
	po_curr     label "币别"	    colon 50
	pt_pur_lead label "采购提前" colon 68

	t_app       label "审核"    colon 5
	pt_desc2    no-label		colon 18
    v_lt        label "满足LT"  colon 68

	t_rmks      label "备注"  colon 5
with frame b side-labels width 80 attr-space.         


		for first temp where t_nbr =  v_nbr and t_line  = v_line no-lock :
			clear frame b no-pause .

			find first pt_mstr where pt_part = t_part no-lock no-error .
			find first po_mstr where po_nbr = t_nbr no-lock no-error .
			find first pod_det where pod_nbr = t_nbr and pod_line  = t_podline no-lock no-error .

			v_lt = no .
			if avail pt_mstr and avail pod_det then do :
				if pod_need - pt_pur_lead >= today then v_lt = yes .
			end.

			disp t_nbr t_line t_app t_rmks v_lt  with frame b .
			if avail pt_mstr then disp pt_desc1 pt_desc2 pt_pur_lead  with frame b .
			if avail pod_det then disp po_Curr po_cr_terms with frame b .
			if avail pod_det then disp pod_part pod_need with frame b .

			
			
		end. /*for first temp*/
